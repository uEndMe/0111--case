# 0111--项目流程

#### 准备

* 项目描述

```
项目描述：
	1. 项目简介：描述，解决需求，使用操作
	2. 技术栈：
		react框架，antdUI库，Axios请求...
		ES6语法，webpack构建工具，可视化图表Echarts...
	3. 主要功能：权限、用户管理，商品、商品分类管理，国际化

技术选型：
	技术总监指定使用的技术栈；	
	
前端路由
	一般由公司搭建；
	
API接口
	前后台通讯的 url 地址
	接口文档：请求类型，请求参数，请求令牌...
```



* 测试接口

```
Postman 工具
测试/联调/对接/接口
...
```



* git 版本控制

```js
配置 npm/yarn
建仓库 
初始化本地,搭建脚手架
	git add .
	git commit -m "xxx"
	git remote add origin pathxxx
	//git remote remove origin
	git push origin master
```

```
克隆
	git clone pathxxx
```

```
已有分支
	git fetch origin xxx:xxx
	git checkout xxx
没有分支
	git checkout -b devxxx
```

```
开发：
本地版本控制：
	git add . 
	git commit -m "xxx"
提交到仓库：
	git push origin pathxxx
	失败
		网络问题，本地没有版本控制
		需要更新：
			git pull origin xxx
```



* 项目目录

```
src
	api 请求
	assets 公共资源
	component UI组件
	config 配置文件
	containers 容器组件
	i18n 国际化
	redux 模块redux
	utils 工具模块
	App.jsx
	index.js
```



#### 配置

##### antd 配置

```js
//antd 官网：
https://ant.design/docs/react/use-with-create-react-app-cn
yran add antd
```

```js
//详见官网文档，此处仅供参考
//自定义配置 react-app-rewired 
yarn add react-app-rewired customize-cra
1. 修改启动方式 package.json
2. 创建 config-overrides.js 配置

//按需加载 react-app-rewired 
yarn add babel-plugin-import
1. 修改 config-overrides.js 文件
2. 引入 antd, 重启

//自定义主题
yarn add less less-loader
1. 修改 config-overrides.js 文件，重启
```



* 配置 ES7 语法装饰， 路径别名

```js
//config-overrides.js
//1. 解构引入 addDecoratorsLegacy, addWebpackAlias
yarn add @babel/plugin-proposal-decorators --dev
```

```js
module.exports = override(
    //语法装饰
    addDecoratorsLegacy(),
    //路径别名    
    addWebpackAlias({
        //...
    })
);
```



* 基本页面

```js
//index.js
引入：react, react-dom, app
渲染：app
//app.js
引入：react
暴露：app
```



##### router 配置

```
yarn add react-router-dom
```

```jsx
//app.jsx
import { BrowserRouter as Router, Route, Switch } from 'react-router-dom';
import Home from './components/home';
import Login from './components/login';
...
	return <Router>
    	<Switch>
            <Route path='/login' exact component={ login }/>
            <Route path='/' exact component={ Home }/>
    	</Switch>
	</Router>
//Switch: 单匹配 （默认多匹配）
//exact: 全匹配 （默认半匹配）
```

```
home页面，login页面 基本配置
```



##### redux 配置

```
yarn add redux react-redux redux-thunk
yarn add redux-devtools-extension --dev
```

```
创建 redux 文件夹： actions / store / reducers
```

```js
//actions.js
//创建 action 对象，的工厂函数
//....
```

```js
//store.js
import { createStore, applyMiddleware } from 'redux';
import thunk from 'redux-thunk';
import { composeWithDevTools } from 'redux-devtools-extension';

import reducers from './reducers';

export default createStore(
    reducers,
    process.env.NODE_ENV === 'development'
    	? composeWithDevTools(applyMiddleware(thunk))
    	: applyMiddleware(thunk)
)
```

```js
//reducers
//根据 prevState 和 action 返回 newState 
import { combineReducers } from 'redux';

function aaa(prevState=0, action) {
    switch (action.type){
        case(1):
            return prevState + action.data ;
        default:
            return prevState;
    }
}
export default combineReducers({
    aaa,
    bbb
})
```

```js
//action-types.js
//定义 action type
/...
```



```jsx
//index.js
import { Provider } from 'react-redux';
import store from './redux/store';
...
	<Provider store={store}>
        <App />
    </ Provider>
```



* 报错

```
报错：找不到store
```

